# ユーザー権限管理

## 概要
Set Planシステムでは、ユーザーは「管理者」と「一般ユーザー」の2つの役割に分かれており、それぞれ異なる権限を持っています。

## 権限一覧表

| 機能カテゴリ | 機能 | 管理者 | 一般ユーザー |
|------------|------|--------|-------------|
| **ユーザー管理** | | | |
| | ユーザー一覧の閲覧 | ○ | × |
| | ユーザーの新規作成 | ○ | × |
| | ユーザー情報の編集 | ○ | △（自分のみ） |
| | ユーザーの削除 | ○ | × |
| | パスワードリセット | ○ | △（自分のみ） |
| | 管理者権限の付与/剥奪 | ○ | × |
| **プロジェクト管理** | | | |
| | プロジェクト一覧の閲覧 | ○ | ○ |
| | プロジェクトの新規作成 | ○ | ○ |
| | プロジェクトの編集 | ○ | ○ |
| | プロジェクトの削除 | ○ | × |
| **予定実績管理** | | | |
| | 全ユーザーの予定実績の閲覧 | ○ | × |
| | 自分の予定実績の閲覧 | ○ | ○ |
| | 自分の予定実績の作成・編集 | ○ | ○ |
| | 他ユーザーの予定実績の編集 | ○ | × |
| | カレンダー表示 | ○ | ○（自分のみ） |
| | グラフ分析表示 | ○ | ○（自分のみ） |
| **課題管理** | | | |
| | 課題一覧の閲覧 | ○ | ○ |
| | 課題の新規作成 | ○ | ○ |
| | 課題の編集 | ○ | △（作成者/担当者のみ） |
| | 課題の削除 | ○ | △（作成者のみ） |
| | 課題へのコメント | ○ | ○ |
| | 課題の担当者変更 | ○ | △（作成者のみ） |
| **ガントチャート** | | | |
| | ガントチャートの閲覧 | ○ | ○ |
| | タスクの編集 | ○ | △（担当タスクのみ） |
| **顧客管理** | | | |
| | 顧客一覧の閲覧 | ○ | ○ |
| | 顧客の新規作成 | ○ | ○ |
| | 顧客情報の編集 | ○ | ○ |
| | 顧客の削除 | ○ | × |
| **見積管理** | | | |
| | 全見積書の閲覧 | ○ | ○ |
| | 見積書の新規作成 | ○ | ○ |
| | 自分の見積書の編集 | ○ | ○ |
| | 他ユーザーの見積書の編集 | ○ | × |
| | 見積書の削除 | ○ | △（自分のみ） |
| | 見積書の複製 | ○ | ○（自分のみ） |
| | 見積書のPDFダウンロード | ○ | ○（自分のみ） |
| | 見積書から請求書への変換 | ○ | ○（自分のみ） |
| **請求書管理** | | | |
| | 全請求書の閲覧 | ○ | ○ |
| | 請求書の新規作成 | ○ | ○ |
| | 自分の請求書の編集 | ○ | ○（下書きのみ） |
| | 他ユーザーの請求書の編集 | ○ | × |
| | 請求書の削除 | ○ | × |
| | 請求書の複製 | ○ | ○（自分のみ） |
| | 請求書のPDFダウンロード | ○ | ○（自分のみ） |
| | 請求書のステータス変更 | ○ | ○（自分のみ） |
| **会社情報管理** | | | |
| | 会社情報の閲覧 | ○ | ○ |
| | 会社情報の編集 | ○ | × |
| | 会社印の登録・更新 | ○ | × |
| | 銀行口座情報の編集 | ○ | × |

## 凡例
- ○：アクセス可能
- ×：アクセス不可
- △：条件付きでアクセス可能（括弧内に条件を記載）

## 権限の特記事項

### 管理者権限
- システムの全機能にアクセス可能
- 全ユーザーのデータを閲覧・編集可能
- システム設定の変更が可能
- ユーザーの権限管理が可能

### 一般ユーザー権限
- 主に自分が作成したデータの管理が可能
- 他ユーザーのデータは基本的に閲覧のみ（一部例外あり）
- プロジェクトや課題など、チームで共有する情報は閲覧・編集可能
- 見積書・請求書は全て閲覧可能、編集は自分が作成したもののみ

### セキュリティ上の制限
1. **パスワード変更**：全ユーザーが自分のパスワードのみ変更可能
2. **削除権限**：破壊的な操作（削除）は管理者に限定（一部例外あり）
3. **請求書の編集**：送付済み請求書は管理者でも編集不可（データの整合性保持）
4. **監査ログ**：重要な操作は全て記録される（実装予定）

## 権限変更の手順

### ユーザーを管理者にする場合
1. 管理者アカウントでログイン
2. ユーザー管理画面へ移動
3. 対象ユーザーの編集画面を開く
4. 「管理者権限」チェックボックスをONにする
5. 保存

### 管理者権限を剥奪する場合
1. 管理者アカウントでログイン
2. ユーザー管理画面へ移動
3. 対象ユーザーの編集画面を開く
4. 「管理者権限」チェックボックスをOFFにする
5. 保存

## 初期管理者アカウント
システムセットアップ時に以下の初期管理者アカウントが作成されます：
- ユーザー名: admin
- パスワード: （環境変数で設定）
- メールアドレス: admin@setplan.co.jp

※本番環境では必ず初期パスワードを変更してください

## 今後の拡張予定
- ロールベースアクセス制御（RBAC）の導入
- カスタムロールの作成機能
- 部門別アクセス制御
- API キーによるアクセス管理
- 監査ログ機能の実装