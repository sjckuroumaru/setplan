# テストデータセットアップガイド

## 概要
このドキュメントでは、開発・テスト環境にサンプルデータを投入する方法を説明します。

## テストデータの内容

### 作成されるデータ
- **ユーザー**: 10名（管理者1名、一般ユーザー9名）
- **プロジェクト**: 10件（様々なステータス）
- **課題**: 60件（コメント付き、ガントチャートデータ含む）
- **スケジュール**: 過去1ヶ月〜1週間後の予定実績
- **コメント**: 各課題に0〜3件のコメント

## セットアップ手順

### 1. データベースのリセット（オプション）
既存のデータをすべて削除して、クリーンな状態から始める場合：

```bash
npm run db:reset
```

このコマンドは以下を実行します：
- データベースの削除
- マイグレーションの再実行
- 基本的なseedデータの投入

### 2. 基本データの投入
最小限の基本データのみ投入する場合：

```bash
npm run db:seed
```

作成されるデータ：
- 管理者ユーザー（admin@example.com / password）
- 一般ユーザー（user@example.com / password）
- サンプルプロジェクト2件

### 3. テストデータの大量投入
60件の課題を含む包括的なテストデータを投入：

```bash
npm run db:seed-test
```

## ログイン情報

### 基本ユーザー（seed.ts）
| メールアドレス | パスワード | 権限 |
|---------------|-----------|------|
| admin@example.com | password | 管理者 |
| user@example.com | password | 一般 |

### テストユーザー（seed-test-data.ts）
| メールアドレス | パスワード | 権限 |
|---------------|-----------|------|
| user1@example.com | password123 | 管理者 |
| user2@example.com | password123 | 一般 |
| user3@example.com | password123 | 一般 |
| ... | ... | ... |
| user10@example.com | password123 | 一般 |

## データの特徴

### 課題データ
- **ステータス分布**: open, in_progress, resolved, closed がランダムに分布
- **優先度**: low, medium, high, critical がランダムに設定
- **ガントチャートデータ**: 60%の課題にガントチャート用の開始日、終了日、進捗率を設定
- **期限**: 70%の課題に期限日を設定
- **担当者**: 80%の課題に担当者をアサイン

### スケジュールデータ
- **期間**: 過去1ヶ月から1週間後まで
- **対象ユーザー**: 最初の5名のユーザー
- **勤務日**: 平日のみ（土日を除く）
- **予定項目**: 各日2〜3個
- **実績項目**: 過去の日付のみ、各日2〜3個

### プロジェクトデータ
- **ステータス**: planning, developing, active, suspended, completed
- **期間**: 2024年1月〜12月でランダムに設定

## トラブルシューティング

### エラー: Unique constraint failed
既にデータが存在する場合に発生します。
解決方法：
1. `npm run db:reset` でデータベースをリセット
2. または、seed-test-data.ts の冒頭のコメントアウトを解除してデータをクリア

### エラー: Cannot connect to database
データベース接続エラーです。
解決方法：
1. `.env` ファイルの `DATABASE_URL` を確認
2. データベースサービスが起動していることを確認

## カスタマイズ

### データ量の変更
seed-test-data.ts の以下の値を変更：
```typescript
// ユーザー数
for (let i = 1; i <= 10; i++) // 10を変更

// 課題数
for (let i = 1; i <= 60; i++) // 60を変更

// プロジェクト数
for (let i = 1; i <= 10; i++) // 10を変更
```

### データ内容のカスタマイズ
seed-test-data.ts の配列データを編集：
```typescript
const departments = ['開発部', '営業部', ...] // 部署名
const issueTitles = ['ログイン機能の不具合修正', ...] // 課題タイトル
const projectNames = ['ECサイトリニューアル', ...] // プロジェクト名
```

## 注意事項

1. **本番環境では実行しないでください**
2. テストデータは開発・テスト環境専用です
3. パスワードは全ユーザー共通なので、セキュリティに注意
4. 大量データ投入には時間がかかる場合があります（約30秒〜1分）

## 推奨される使用方法

### 開発環境の初期セットアップ
```bash
# 1. データベースをクリーンな状態にリセット
npm run db:reset

# 2. テストデータを投入
npm run db:seed-test
```

### デモ環境の準備
```bash
# 基本データのみ投入（クリーンなデモ用）
npm run db:seed
```

### パフォーマンステスト
```bash
# 大量データでのパフォーマンステスト
npm run db:seed-test
```